// StockTradingSystem.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include <iostream>
#include <vector>
#include <string>

//including classes
#include "StockTrade.h"
#include "Account.h"
#include "User.h"

using namespace std;

//global variable
int loggedin = 0;
int globalid = 4;
int stockglobalid = 8;
vector<StockTrade> vect;
vector<User> vectuser;

//option 1
void Option1()
{
   
    int selection;
    Account accounts;
    Sell sell;
    Purchase buy;
    do
    {
        //Option 1 
        cout << "Option 1 Menu" << endl;
        cout << "1: Buy" << endl;
        cout << "2: Sell" << endl;
        cout << "3: Display" << endl;
        cout << "10: clear screen" << endl;
        cout << "0: Return to main menu" << endl;
        cout << "Enter selection:" << endl;
        cin >> selection;
        if (selection == 1)
        {
            cout << "You have Entered Option 1" << endl;
            double n = 0;
            double m = 0;
            double h = 0;
            cout << "Please select id of the StockBroker to purchase" << endl;
            cin >> n;
            double temp = vectuser[n - 1].getBalance();
            double temp6 = vectuser[n - 1].getQuantity();
            cout << "Please select id of the Stock Option you would like to purchase" << endl;
            cin >> h;
            double temp7 = vect[h - 1].getStockPrice();
            cout << "Please enter how much you want to purchase" << endl;
            cin >> m;
            buy.setQuantity(temp6);
            buy.setprice(temp7);
            double temp4 = buy.buy(m);
            double temp5 = buy.getQuantity();
            double temp1 = buy.getBalance();

            
            if (temp > temp1) {
                double result = temp + temp1;
                vectuser[n - 1].setBalance(result);
                cout << "New Balance: $" << vectuser[n - 1].getBalance() << endl;
                cout << "Fee Charge of: $" << buy.getfee() << endl;
                cout << "New Stock Quantity is now: " << buy.getQuantity() << endl;
                cout << "You Bought at Stock Price: $" << temp7 << endl;
                vectuser[n - 1].setQuantity(buy.getQuantity());
            }
            else {
                cout << "insufficent fund" << endl;
            }
            system("pause");
        }
        else if (selection == 2)
        {
            cout << "You have Entered Option 1" << endl;
            double n = 0;
            double m = 0;
            cout << "Please select id of the StockBroker to Sell" << endl;
            cin >> n;
            double temp = vectuser[n - 1].getBalance();
            double temp6 = vectuser[n - 1].getQuantity();
            cout << "Please enter how much you want to Sell" << endl;
            cin >> m;
            sell.setQuantity(temp6);
            double temp4 = sell.SoldFee(m);
            double temp5 = sell.getQuantity();
            double temp1 = sell.getBalance();
            if (temp5 > 0) {
                if (temp5 > temp4){
                    double result = temp - temp1;
                    vectuser[n - 1].setBalance(result);
                    cout << "New Balance: $" << vectuser[n - 1].getBalance() << endl;
                    cout << "Fee Charge of: $" << sell.getfee() << endl;
                    cout << "Stock Quantity is now " << sell.getQuantity() << endl;
                    vectuser[n - 1].setQuantity(sell.getQuantity());
                }
            }
            else {
                cout << "not enough stocks available" << endl;
            }
            system("pause");
        }
        else if (selection == 3)
        {
            cout << "You have Entered Option 3" << endl;
            int n = 0;
            cout << "Please select id of the StockBroker to display Balance" << endl;
            cin >> n;
            cout << "Balance is: $" << vectuser[n - 1].getBalance();
            system("pause");
        }
        else if (selection == 10)
        {
            system("CLS");
        }
        else
        {

            cout << "Please Enter the correct number choices in menu" << endl;
        }
         

    } while (selection != 0);
    sell.~Sell();
    buy.~Purchase();
    accounts.~Account();
}
void Option2()
{
    int selection;
    do
    {
        //Option 2 
        cout << "Option 2 Menu" << endl;
        cout << "1: Display StockBroker Information" << endl;
        cout << "2: Add StockBroker Information" << endl;
        cout << "3: Remove StockBroker Information" << endl;
        cout << "10: clear screen" << endl;
        cout << "0: Return to main menu" << endl;
        cout << "Enter selection:" << endl;
        cin >> selection;
        if (selection == 1)
        {
            cout << "_____________________________________________" << endl;
            for (int i = 1; i < vect.size() + 1; i++) {
                string temp1 = vect[i - 1].getStockTrade();
                if (temp1 != "Null") {
                    vect[i - 1].showInfo();
                    cout << endl;
                }
            }
            cout << "All user information displayed" << endl;
            system("pause");
        }
        else if (selection == 2)
        {
            string StockTradeName = "";
            int id = stockglobalid;
            string StockSymbol = "";
            double price = 0;
            cout << "Please enter the name of the stock" << endl;
            cin >> StockTradeName;
            cout << "Please enter the symbol of stock" << endl;
            cin >> StockSymbol;
            cout << "Please enter the stock price" << endl;
            cin >> price;
            vect.push_back(StockTrade(StockSymbol, stockglobalid, StockTradeName, price));
            cout << "You have succesfully added an stock" << endl;
            cout << "The User ID is: " << stockglobalid << endl;
            stockglobalid++;
            system("pause");
        }
        else if (selection == 3)
        {
            int num = 0;
            int position = 0;
            cout << "Please enter id number of the Stock Trade to remove from the list" << endl;
            cin >> num;
            position = (num - 1);
            if (num > 0)
            {
                vect[num - 1].setStockTrade("Null");
                vect[num - 1].setTradeID(0);
                vect[num - 1].setStockSymbol ("Null");
                cout << "You have successfully removed user from the list!" << endl;
            }
            else
            {
                cout << "you enter wrong number please try agian";
            }
            system("pause");
        }
        else if (selection == 10)
        {
            system("CLS");
        }
        else
        {

            cout << "Please Enter the correct number choices in menu" << endl;
        }

    } while (selection != 0);
}
void Option3()
{
    int selection;
    do
    {
        //Option 3 
        cout << "Option 3 Menu" << endl;
        cout << "1: Add User" << endl;
        cout << "2: Remove User" << endl;
        cout << "3: Display All User" << endl;
        cout << "10: clear screen" << endl;
        cout << "0: Return to main menu" << endl;
        cout << "Enter selection:" << endl;
        cin >> selection;
        if (selection == 1)
        {
            string name = "";
            int id = globalid;
            int age = 0;
            double balance = 0;
            double stockquantity = 0;
            cout << "Please enter the name of the user" << endl;
            cin >> name;
            cout << "Please enter the age" << endl;
            cin >> age;
            cout << "Please enter the balance of user" << endl;
            cin >> balance;
            cout << "Please enter the stockquantity" << endl;
            cin >> stockquantity;
            vectuser.push_back(User(name, globalid, age, balance, stockquantity));
            cout << "You have succesfully added an user" << endl;
            cout << "The User ID is: " << globalid << endl;
            globalid++;
            system("pause");
        }
        else if (selection == 2)
        {
            int num = 0;
            int position = 0;
            cout << "Please enter id number of the User to remove from the list" << endl;
            cin >> num;
            position = (num - 1);
            if (num > 0)
            {
                vectuser[num - 1].setName("Null");
                vectuser[num - 1].setId(0);
                vectuser[num - 1].setAge(0);
                vectuser[num - 1].setBalance(0);
                vectuser[num - 1].setQuantity(0);
                cout << "You have successfully removed user from the list!" << endl;
            }
            else
            {
                cout << "you enter wrong number please try agian";
            }
            
            system("pause");
        }
        else if (selection == 3)
        {
            cout << "_____________________________________________" << endl;
            for (int i = 1; i < vectuser.size() + 1; i++) {
                string temp1 = vectuser[i - 1].getName();
                if (temp1 != "Null") {
                    vectuser[i - 1].showInfo();
                    cout << endl;
                }
            }
            cout << "All user information displayed" << endl;
            system("pause");
        }
        else if (selection == 10)
        {
            system("CLS");
        }
        else
        {

            cout << "Please Enter the correct number choices in menu" << endl;
        }

    } while (selection != 0);
}
//Main Menu
void MainMenu()
{
    int selection;
    do
    {
        //Main menu options
        cout << "Main Menu" << endl;
        cout << "1: Stock Exchange" << endl;
        cout << "2: Stock Information (including add/remove stock options)" << endl;
        cout << "3: add/remove user" << endl;
        cout << "10: clear screen" << endl;
        cout << "0: End Program" << endl;
        cout << "Enter selection:" << endl;
        cin >> selection;
        if (selection == 1)
        {
            Option1();
        }
        else if (selection == 2)
        {
            Option2();
        }
        else if (selection == 3)
        {
            Option3();
        }
        else if (selection == 10)
        {
            system("CLS");
        }
        else if (selection == 0)
        {
            cout << "END OF PROGRAM THANK YOU FOR USING IT!" << endl;
        }
        else
        {
            cout << "Please Enter the correct number choices in menu" << endl;
        }

    } while (selection != 0);
    
}
void Login()
{
    //log in menu
    int password = 1111;
    int username = 1111;
    int pass = 0;
    int user = 0;
    int attempt = 0;
    while (true) {
        cout << "Welcome To Stock TradingSystem." << endl;
        cout << "Please enter your username and password." << endl;
        cout << "For demonstration purposes the password and username is (1111)" << endl;
        cout << "Username:" << endl;
        cin >> user;
        cout << "Enter Your Password: " << endl;
        cin >> pass;
        if (pass == password && user == username) {
            cout << "You have successfully logged in" << endl;
            loggedin = 1;
            break;
        }
        else
        {
            cout << "You entered the wrong user name and/or password" << endl;
        }
        attempt = attempt + 1;
        cout << "You have three attempts this is attempt: #" << attempt << endl;
        if (attempt == 3) {
            cout << "You have failed to log in, System Shutdown!" << endl;
            loggedin = 0;
            break;
        }
    }
}
int main()
{
    //pre load members
    vectuser.push_back(User("user1", 1, 25, 10000 , 100));
    vectuser.push_back(User("user2", 2, 20, 10000, 100));
    vectuser.push_back(User("user3", 3, 20, 10000,100));


    vect.push_back(StockTrade("Agilent Technologies", 1, "A", 10));
    vect.push_back(StockTrade("Apple", 2, "APPL", 20));
    vect.push_back(StockTrade("Berkshire Hathaway", 3, "BRK", 10));
    vect.push_back(StockTrade("Citigroup", 4, "C", 20));
    vect.push_back(StockTrade("Google", 5, "GOOG", 20));
    vect.push_back(StockTrade("Intel", 6, "INTC", 10));
    vect.push_back(StockTrade("Microsoft", 7, "MSFT", 30));
    
    //login menu
    Login();

    //main menu
    if (loggedin == 1)
    {
        system("CLS");
        //call the menu
        MainMenu();
    }
    //unsuccessful attempt 
    else
    {
        system("CLS");
        cout << "You have entered the wrong information too many times" << endl;
        cout << "Have a nice day!" << endl;
    }
    return 0;
}


